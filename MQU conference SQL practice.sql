
/******* TASK 1: Table creation ***********/

CREATE TABLE BUILDING (
BUILDINGNO CHAR(2),
BUILDINGWING VARCHAR2(15),
BUILDINGLANE VARCHAR2(15),
CONSTRAINT BUILDING_PK PRIMARY KEY (BUILDINGNO));

CREATE TABLE ROOM (
BUILDINGNO CHAR(2),
ROOMNO CHAR(2),
ROOMCAPACITY NUMBER(3),
CONSTRAINT ROOM_PK PRIMARY KEY (BUILDINGNO,ROOMNO),
CONSTRAINT ROOM_FK FOREIGN KEY (BUILDINGNO) REFERENCES BUILDING(BUILDINGNO));

CREATE TABLE SPEAKER (
SPEAKERID CHAR(2),
SPEAKERNAME VARCHAR2(20),
SPEAKERADDRESS VARCHAR(50),
SPEAKERPHONE CHAR(12),
CONSTRAINT SPEAKER_PK PRIMARY KEY (SPEAKERID));

CREATE TABLE CONFERENCESESSION(
SESSIONID CHAR(4),
BUILDINGNO CHAR(2),
ROOMNO CHAR(2),
SPEAKERID CHAR(2),
SESSIONDATE DATE,
SESSIONPRICE NUMBER(4,2),
CONSTRAINT SESSION_PK PRIMARY KEY (SESSIONID),
CONSTRAINT SESSION_FK1 FOREIGN KEY (BUILDINGNO,ROOMNO) REFERENCES ROOM(BUILDINGNO,ROOMNO),
CONSTRAINT SESSION_FK2 FOREIGN KEY (SPEAKERID) REFERENCES SPEAKER(SPEAKERID));
 
/******* TASK 2: Table population ***********/

INSERT INTO BUILDING VALUES ('B1','NORTH WEST','WALLY''S WALK');
INSERT INTO BUILDING VALUES ('B2','NORTH','HOUSTON ROAD');
INSERT INTO BUILDING VALUES ('B3','WEST','LEIGH''S AVENUE');
INSERT INTO BUILDING VALUES ('B4','SOUTH EAST','BEECROFT ROAD');

INSERT INTO ROOM VALUES ('B1','R1',121);
INSERT INTO ROOM VALUES ('B1','R2',253);
INSERT INTO ROOM VALUES ('B2','R1',275);
INSERT INTO ROOM VALUES ('B2','R2',126);
INSERT INTO ROOM VALUES ('B2','R3',124);
INSERT INTO ROOM VALUES ('B3','R1',256);
INSERT INTO ROOM VALUES ('B3','R2',324);
INSERT INTO ROOM VALUES ('B4','R1',431);
INSERT INTO ROOM VALUES ('B4','R2',345);
INSERT INTO ROOM VALUES ('B4','R3',231);

INSERT INTO SPEAKER VALUES ('S1','ANAKIN SKYWALKER','12, KHALEESI ST, WESTEROS, NSW-2113','(02)98773241');
INSERT INTO SPEAKER VALUES ('S2','LEIA ORGANA','22, SANSA AV, WINTERFELL, VIC-3125','(03)93244362');
INSERT INTO SPEAKER VALUES ('S3','LUKE SKYWALKER','67, JON ARRYN RD, VALE, NSW-2338','(02)92341203');
INSERT INTO SPEAKER VALUES ('S4','CHEWBACCA','92, OBERYN ST, DORN, VIC-3199','(03)91210988');
INSERT INTO SPEAKER VALUES ('S5','R2D2','90, THEON RD, IRON ISLANDS, NSW-2192','(02)91239890');
INSERT INTO SPEAKER VALUES ('S6','YODA','56, CERCEI LN, KINGS LANDING, NSW-2144','(02)91250359');

INSERT INTO CONFERENCESESSION VALUES ('SS01','B1','R1','S1','3/MAY/2017',12.50);
INSERT INTO CONFERENCESESSION VALUES ('SS02','B2','R1','S2','4/JUN/2017',19.45);
INSERT INTO CONFERENCESESSION VALUES ('SS03','B1','R2','S2','13/MAY/2017',12.67);
INSERT INTO CONFERENCESESSION VALUES ('SS04','B4','R2','S4','13/JUN/2017',14.56);
INSERT INTO CONFERENCESESSION VALUES ('SS05','B3','R2','S5','23/MAY/2017',14.56);
INSERT INTO CONFERENCESESSION VALUES ('SS06','B3','R1','S5','3/JUN/2017',16.32);
INSERT INTO CONFERENCESESSION VALUES ('SS07','B4','R2','S3','13/MAY/2017',21.78);
INSERT INTO CONFERENCESESSION VALUES ('SS08','B1','R2','S2','6/JUN/2017',16.82);
INSERT INTO CONFERENCESESSION VALUES ('SS09','B2','R3','S4','13/MAY/2017',17.90);
INSERT INTO CONFERENCESESSION VALUES ('SS10','B4','R1','S3','6/JUN/2017',16.37);


/******* TASK 3: Query execution ***********/

SELECT * 
FROM BUILDING 
WHERE BUILDINGLANE LIKE '%ROAD' 
AND BUILDINGWING LIKE 'NORTH%'
ORDER BY BUILDINGNO DESC;



SELECT SPEAKERNAME "NAME", SUBSTR(SPEAKERADDRESS,-4) "ADDRESS"
FROM SPEAKER;


SELECT SPEAKERID , SPEAKERNAME
FROM SPEAKER 
WHERE SPEAKERNAME LIKE '% %'
AND SPEAKERADDRESS LIKE '%VIC%';


SELECT BUILDINGNO, ROOMNO,  ROOMCAPACITY ||' PEOPLE' "ROOMCAPACITY"
FROM ROOM 
WHERE( BUILDINGNO = 'B1' OR BUILDINGNO = 'B4')
AND ROOMCAPACITY NOT  BETWEEN 120 AND 160;


SELECT SESSIONID, SESSIONDATE, '$ '|| SESSIONPRICE "SESSIONPRICE" 
FROM CONFERENCESESSION
WHERE SESSIONDATE BETWEEN '01-JUN-2017' AND '30-JUN-2017'
OR SESSIONPRICE<=14
ORDER BY SESSIONDATE DESC;


SELECT SESSIONID, SESSIONDATE
FROM CONFERENCESESSION, SPEAKER
WHERE CONFERENCESESSION.SPEAKERID = SPEAKER.SPEAKERID
AND SPEAKERPHONE LIKE '%(03)%';


SELECT SESSIONID, SESSIONDATE
FROM CONFERENCESESSION 
WHERE SPEAKERID IN 
(SELECT SPEAKERID
FROM SPEAKER
WHERE SPEAKER.SPEAKERPHONE LIKE '%(03)%');


SELECT SESSIONID , CONFERENCESESSION.BUILDINGNO, CONFERENCESESSION.ROOMNO
FROM CONFERENCESESSION, ROOM
WHERE CONFERENCESESSION.ROOMNO = ROOM.ROOMNO AND CONFERENCESESSION.BUILDINGNO= ROOM.BUILDINGNO
AND CONFERENCESESSION.BUILDINGNO!='B2' 
AND ROOMCAPACITY >= 180;


SELECT C.* , LOWER(SPEAKERNAME) "SPEAKERNAME"
FROM CONFERENCESESSION C , SPEAKER S
WHERE C.SPEAKERID=S.SPEAKERID
AND (SUBSTR(SPEAKERNAME,3,1)='A' OR LENGTH(SPEAKERNAME)<7);


SELECT BUILDINGNO, ROOMNO, COUNT(SESSIONID) AS NUMBER_OF_SESSIONS
FROM CONFERENCESESSION 
GROUP BY BUILDINGNO,ROOMNO
ORDER BY BUILDINGNO,NUMBER_OF_SESSIONS;



SELECT BUILDINGNO, AVERAGE_PRICE
FROM(
    SELECT BUILDINGNO ,  AVG(SESSIONPRICE) AS AVERAGE_PRICE 
    FROM CONFERENCESESSION
    GROUP BY BUILDINGNO
    ORDER BY AVG(SESSIONPRICE) DESC) TEMP
WHERE ROWNUM<=2;



SELECT C.SESSIONID, BUILDINGWING, SPEAKERNAME , ROOMCAPACITY, SESSIONDATE
FROM CONFERENCESESSION C, SPEAKER S, BUILDING B,ROOM R 
WHERE C.BUILDINGNO=B.BUILDINGNO
AND C.BUILDINGNO=R.BUILDINGNO
AND C.ROOMNO = R.ROOMNO
AND C.SPEAKERID=S.SPEAKERID
AND (SESSIONDATE = '6-JUN-17' OR SESSIONDATE = '13-MAY-17');


SELECT SESSIONID , (SESSIONPRICE*ROOMCAPACITY) AS TOTALPRICE
FROM CONFERENCESESSION C , ROOM R
WHERE C.BUILDINGNO=R.BUILDINGNO
AND C.ROOMNO = R.ROOMNO
AND (SESSIONPRICE*ROOMCAPACITY) > 5000
ORDER BY TOTALPRICE DESC ;
/*
End of file
/

